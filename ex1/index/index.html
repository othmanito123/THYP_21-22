<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THYP 21-22</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
    <h1>THYP 21-22</h1>
    <div id="listeEtus"></div>

    <script>
        const urlCSV = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRdS98rMMSO2Q_ZFdhz5EtUcdOQDIXt9xxH0810u19IrEu9kBowuwn3O-ar2aIqVeV0tNPnIYGx4oug/pub?gid=773050088&single=true&output=csv";

        d3.csv(urlCSV).then((dataCSV) => {
            console.log(dataCSV); 
           let divEtus = d3.select('#listeEtus').selectAll('div').data(dataCSV).enter().append('div')
            .attr('id',(d,i)=>'etu_'+i+'_'+d['N° étudiant']);
            divEtus.append('h2').text(d=>{
                let pn = '';
                 d['Votre prénom'].split(' ').forEach(p => {
                     pn+= p.charAt(0).toUpperCase() + p.substring(1).toLowerCase();
                     
                 });
                
                pn += ' '+d['Votre nom'].toUpperCase()
                return pn;
            });
        });
        </script>
    
</body>
</html>